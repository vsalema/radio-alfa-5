<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Flame FM ‚Äì Web Radio</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #333 0, #050505 55%);
      color: #fff;
    }

    .radio-wrapper {
      width: 900px;
      max-width: 96vw;
      aspect-ratio: 16 / 9;
      position: relative;
    }

    .radio-shell {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 26px;
      background:
        radial-gradient(circle at 20% 15%, rgba(255,255,255,0.3) 0, transparent 45%),
        radial-gradient(circle at 80% 15%, rgba(255,255,255,0.28) 0, transparent 45%),
        linear-gradient(135deg, #ff6a00, #ff3d00 45%, #b02000 100%);
      box-shadow:
        0 28px 60px rgba(0,0,0,0.8),
        inset 0 0 0 3px rgba(0,0,0,0.6);
      padding: 18px 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
   background-image: url("https://t4.ftcdn.net/jpg/05/10/48/51/240_F_510485158_vyozgwyVPi2SUP246x2CIXyQOCNvyvtp.jpg");
  background-repeat: no-repeat;
  background-size: 178%;
    
    }

    .radio-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .brand {
      font-weight: 800;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      font-size: 0.9rem;
      color: #ffe0b2;
      text-shadow: 0 2px 4px rgba(0,0,0,0.7);
    }

    .freq-window {
      flex: 1;
      margin: 0 1rem;
      padding: 8px 14px;
      border-radius: 999px;
      background: linear-gradient(to bottom, #262626, #050505);
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow:
        inset 0 0 12px rgba(0,0,0,0.9),
        0 2px 5px rgba(0,0,0,0.7);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    .freq-scale {
      flex: 1;
      font-size: 0.75rem;
      color: #e0e0e0;
      opacity: 0.9;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .freq-row {
      display: flex;
      justify-content: space-between;
      font-variant-numeric: tabular-nums;
    }

    .freq-current {
      font-size: 1.4rem;
      font-weight: 700;
      color: #ffcc80;
      text-shadow: 0 2px 6px rgba(0,0,0,0.9);
      margin-left: 12px;
    }

    .status-led {
      width: 11px;
      height: 11px;
      border-radius: 50%;
      background: #ff5252;
      box-shadow: 0 0 12px rgba(255,82,82,0.9);
      margin-left: 10px;
    }

    .radio-mode {
      font-size: 0.75rem;
      text-align: right;
      opacity: 0.9;
    }

    .radio-center {
      flex: 1;
      display: grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 18px;
    }

    .center-left {
      border-radius: 18px;
      padding: 14px 18px;
      background:
        radial-gradient(circle at center, rgba(0,0,0,0.75) 0, rgba(0,0,0,0.9) 60%),
        repeating-linear-gradient(
          60deg,
          rgba(255,255,255,0.04) 0,
          rgba(255,255,255,0.04) 2px,
          transparent 2px,
          transparent 6px
        );
      box-shadow:
        inset 0 0 22px rgba(0,0,0,0.9),
        0 4px 10px rgba(0,0,0,0.7);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .glass-screen {
  position: absolute;
  inset: 0;
  border-radius: 16px;

  /* Lumi√®re + transparence */
  background:
    linear-gradient(
      135deg,
      rgba(255,255,255,0.18) 0%,
      rgba(255,255,255,0.02) 40%,
      rgba(255,255,255,0.08) 60%,
      rgba(255,255,255,0.01) 100%
    ),
    rgba(255,255,255,0.03);

  backdrop-filter: blur(3px) brightness(1.08);
  -webkit-backdrop-filter: blur(3px) brightness(1.08);

  /* ‚òÖ‚òÖ‚òÖ Border effet vitre ‚òÖ‚òÖ‚òÖ */
  border: 1.8px solid rgba(255, 255, 255, 0.42);          /* bord blanc l√©ger */
  box-shadow:
    inset 0 0 8px rgba(255,255,255,0.20),                /* luminosit√© int√©rieure */
    inset 0 0 22px rgba(0,0,0,0.35),                     /* ombre int√©rieure */
    0 3px 12px rgba(0,0,0,0.45),                         /* ombre sous la vitre */
    0 -2px 6px rgba(255,255,255,0.25);                   /* reflet en haut */

  opacity: 0.28;
  z-index: 4;
  pointer-events: none;
}


    
 #visualizerCanvas {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.station-logo {
  position: absolute;
  z-index: 1;
}

.station-title,
.station-meta {
  position: relative;
  z-index: 2;
}
   /* Canvas visualizer derri√®re le logo */
    #visualizerCanvas {
      position: absolute;
      inset: 10px;
      width: calc(100% - 20px);
      height: calc(100% - 20px);
      z-index: 0;
      opacity: 0.8;
      pointer-events: none;
    }

    .station-logo {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 60%;
      max-width: 260px;
      aspect-ratio: 1 / 1;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.9;
      filter: drop-shadow(0 6px 14px rgba(0,0,0,0.8));
      pointer-events: none;
      z-index: 0;
    }

    .station-title {
      position: relative;
      z-index: 1;
      font-size: 1.7rem;
      font-weight: 800;
      text-align: center;
      text-shadow: 0 3px 8px rgba(0,0,0,0.9);
    }

    .station-meta {
      position: relative;
      z-index: 1;
      font-size: 0.9rem;
      opacity: 0.9;
      text-align: center;
    }

    .center-right {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 12px;
      border-radius: 18px;
      padding: 14px 16px;
      background:
        linear-gradient(to bottom right, rgba(0,0,0,0.92), rgba(0,0,0,0.85));
      box-shadow:
        inset 0 0 18px rgba(0,0,0,0.9),
        0 4px 10px rgba(0,0,0,0.7);
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    button, select, input {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 0.9rem;
      outline: none;
    }

    button {
      cursor: pointer;
      background: rgba(255,255,255,0.10);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.25);
      backdrop-filter: blur(4px);
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
      background: rgba(255,255,255,0.18);
    }

    button:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #ff9800, #ff5722);
      border: none;
      box-shadow: 0 6px 14px rgba(0,0,0,0.6);
      font-weight: 600;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #ffb74d, #ff7043);
    }

    .station-select {
      min-width: 210px;
      background: rgba(0,0,0,0.7);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.24);
    }

    .volume-row {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.8rem;
      opacity: 0.85;
    }

    .volume-row input[type="range"] {
      flex: 1;
    }

    .radio-bottom {
      border-radius: 18px;
      padding: 10px 14px;
      background: linear-gradient(to right, rgba(0,0,0,0.9), rgba(0,0,0,0.75));
      box-shadow:
        inset 0 0 12px rgba(0,0,0,0.9),
        0 3px 8px rgba(0,0,0,0.7);
      font-size: 0.78rem;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .add-form {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .add-form input {
      background: rgba(0,0,0,0.65);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.25);
      min-width: 145px;
    }

    .hint {
      opacity: 0.75;
    }

    @media (max-width: 780px) {
      .radio-shell {
        padding: 14px;
      }
      .radio-center {
        grid-template-columns: 1fr;
      }
      .station-title {
        font-size: 1.3rem;
      }
    }
  
  .station-row {
  width: 100%;
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  gap: 14px;
}

.nav-btn {
  padding: 10px 16px;
  font-size: 0.95rem;
  border-radius: 999px;
  background: rgba(255,255,255,0.10);
  color: #fff;
  border: 1px solid rgba(255,255,255,0.25);
  backdrop-filter: blur(4px);
  transition: 0.2s ease;
  white-space: nowrap;
}

.nav-btn:hover {
  background: rgba(255,255,255,0.18);
}

.station-select {
  width: 100%;
  min-width: 180px;
  text-align: center;
}
@media (max-width: 560px) {
  .nav-btn {
    padding: 10px;          /* plus compact */
    font-size: 1.2rem;      /* ic√¥ne large */
  }

  .nav-btn::after {
    content: "";            /* retire le texte */
  }
}

  
  </style>
</head>
<body>
<div class="radio-wrapper">
  <div class="radio-shell">
    <!-- Haut -->
    <div class="radio-top">
      <div class="brand">FLAME&nbsp;FM</div>

      <div class="freq-window">
        <div class="freq-scale">
          <div class="freq-row">
            <span>FM</span>
            <span>88</span><span>92</span><span>96</span><span>100</span><span>104</span><span>108</span>
          </div>
          <div class="freq-row" style="opacity:0.7;">
            <span>MHz</span>
            <span>‚óè</span><span>‚óè</span><span>‚óè</span><span>‚óè</span><span>‚óè</span><span>‚óè</span>
          </div>
        </div>
        <div class="freq-current" id="freqMain">00.0</div>
        <div class="status-led" id="statusLed"></div>
      </div>

      <div class="radio-mode">FM ¬∑ WEB STREAM</div>
    </div>

    <!-- Centre -->
    <div class="radio-center">
      <div class="center-left">
        <!-- Visualizer derri√®re le logo -->
        <canvas id="visualizerCanvas"></canvas>
        <div class="glass-screen"></div>
        <div class="station-logo" id="stationLogo"></div>

        <div class="station-title" id="stationName">S√©lectionne une station</div>
        <div class="station-meta" id="stationMeta">‚Äî</div>
      </div>

      <div class="center-right">
        <div class="controls-row station-row">
  <button id="prevBtn" class="nav-btn" data-full="‚èÆ Pr√©c√©dente">‚èÆ</button>

  <select id="stationSelect" class="station-select"></select>

  <button id="nextBtn" class="nav-btn" data-full="Suivante ‚è≠">‚è≠</button>
</div>
        <div class="controls-row">
          <button id="playPauseBtn" class="btn-primary">‚ñ∂Ô∏è Lecture</button>
          <button id="stopBtn">‚èπ Stop</button>
        </div>
        <div class="volume-row">
          <span>Volume</span>
          <input type="range" min="0" max="1" step="0.01" id="volumeSlider" />
        </div>
      </div>
    </div>

    <!-- Bas -->
    <div class="radio-bottom">
      <div class="hint">
        üí° Tu peux brancher tes propres radios : indique simplement nom, fr√©quence et URL de flux audio.
      </div>
      <form class="add-form" id="addForm">
        <input type="text" id="newName" placeholder="Nom de la station" required />
        <input type="text" id="newFreq" placeholder="Fr√©quence (ex : 92.3)" required />
        <input type="text" id="newUrl" placeholder="URL du flux audio" required />
        <button type="submit">‚ûï Ajouter</button>
      </form>
    </div>
  </div>
</div>

<!-- Player audio central -->
<audio id="audioPlayer" crossorigin="anonymous"></audio>

<script>
  // --- Stations (tu peux en ajouter autant que tu veux) ---
  const stations = [
    {
      name: "Radio Alfa",
      freq: 98.6,
      url: "https://n16a-eu.rcs.revma.com/amrbkhqtkm0uv?rj-ttl=5&rj-tok=AAABjyZZV10A8pNBeIWHkkzM-w",
      city: "Paris",
      desc: "Communaut√© lusophone",
      logo: "https://radioalfa.net/wp-content/uploads/2023/02/logo-radio-alfa-DAB-avril-2021-294x300.png"
    },
    {
      name: "Radio Comercial",
      freq: 97.7,
      url: "https://stream-icy.bauermedia.pt/comercial.mp3",
      city: "Lisboa",
      desc: "Hits & talk",
      logo: "https://www.zupimages.net/up/24/18/ywnd.png"
    },
    {
      name: "M80",
      freq: 104.7,
      url: "https://stream-icy.bauermedia.pt/m80.aac",
      city: "Portugal",
      desc: "80s / Classics",
      logo: "https://upload.wikimedia.org/wikipedia/commons/0/02/M80_Portugal.svg"
    }
  ];

  const audio = document.getElementById("audioPlayer");
  const stationSelect = document.getElementById("stationSelect");
  const stationName = document.getElementById("stationName");
  const stationMeta = document.getElementById("stationMeta");
  const freqMain = document.getElementById("freqMain");
  const statusLed = document.getElementById("statusLed");
  const playPauseBtn = document.getElementById("playPauseBtn");
  const stopBtn = document.getElementById("stopBtn");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const addForm = document.getElementById("addForm");
  const newName = document.getElementById("newName");
  const newFreq = document.getElementById("newFreq");
  const newUrl = document.getElementById("newUrl");
  const volumeSlider = document.getElementById("volumeSlider");

  let currentIndex = -1;
  let isPlaying = false;

  audio.volume = 0.7;
  volumeSlider.value = audio.volume;

  // --- Visualizer ---
  let audioCtx = null;
  let analyser = null;
  let dataArray = null;
  let sourceNode = null;
  let animationId = null;
  const canvas = document.getElementById("visualizerCanvas");
  let ctx = null;
  if (canvas && canvas.getContext) {
    ctx = canvas.getContext("2d");
  }

  function refreshStationOptions() {
    stationSelect.innerHTML = "";
    stations.sort((a, b) => a.freq - b.freq);
    stations.forEach((st, index) => {
      const opt = document.createElement("option");
      opt.value = index;
      opt.textContent = `${st.freq.toFixed(1)} MHz ‚Äì ${st.name}`;
      stationSelect.appendChild(opt);
    });

    if (stations.length > 0) {
      currentIndex = 0;
      stationSelect.value = 0;
      updateUIForStation();
    } else {
      currentIndex = -1;
      updateUIForNoStation();
    }
  }

  function updateUIForNoStation() {
    stationName.textContent = "Aucune station configur√©e";
    stationMeta.textContent = "Ajoute une station en bas du poste.";
    freqMain.textContent = "00.0";
    const logoEl = document.getElementById("stationLogo");
    logoEl.style.backgroundImage = "none";
    logoEl.style.opacity = "0";
    statusLed.style.background = "#555";
    statusLed.style.boxShadow = "none";
    playPauseBtn.textContent = "‚ñ∂Ô∏è Lecture";
    isPlaying = false;
    stopVisualizer();
  }

  function updateUIForStation() {
    if (currentIndex < 0 || currentIndex >= stations.length) {
      updateUIForNoStation();
      return;
    }

    const st = stations[currentIndex];
    stationName.textContent = st.name;
    stationMeta.textContent =
      `${st.freq.toFixed(1)} MHz ¬∑ ${st.city} ¬∑ ${st.desc || ""}`;
    freqMain.textContent = st.freq.toFixed(1);

    const logoEl = document.getElementById("stationLogo");
    if (st.logo) {
      logoEl.style.backgroundImage = `url(${st.logo})`;
      logoEl.style.opacity = "0.9";
    } else {
      logoEl.style.backgroundImage = "none";
      logoEl.style.opacity = "0";
    }
  }

  function setStatusPlaying(playing) {
    isPlaying = playing;
    if (playing) {
      statusLed.style.background = "#4caf50";
      statusLed.style.boxShadow = "0 0 12px rgba(76,175,80,0.95)";
      playPauseBtn.textContent = "‚è∏ Pause";
    } else {
      statusLed.style.background = "#ff5252";
      statusLed.style.boxShadow = "0 0 12px rgba(255,82,82,0.95)";
      playPauseBtn.textContent = "‚ñ∂Ô∏è Lecture";
    }
  }

  function loadCurrentStation(autoPlay = true) {
    if (currentIndex < 0 || currentIndex >= stations.length) return;
    const st = stations[currentIndex];
    audio.src = st.url;
    updateUIForStation();
    if (autoPlay) {
      audio.play().then(() => {
        setStatusPlaying(true);
        startVisualizer();
      }).catch((err) => {
        console.warn("Lecture impossible :", err);
        setStatusPlaying(false);
        stopVisualizer();
      });
    }
  }

  function initVisualizer() {
    if (!ctx || !canvas) return;
    if (audioCtx && analyser && sourceNode) return;

    try {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (!sourceNode) {
        sourceNode = audioCtx.createMediaElementSource(audio);
        analyser = audioCtx.createAnalyser();
        analyser.fftSize = 256;
        const bufferLength = analyser.frequencyBinCount;
        dataArray = new Uint8Array(bufferLength);
        sourceNode.connect(analyser);
        analyser.connect(audioCtx.destination);
      }
    } catch (e) {
      console.warn("Visualizer d√©sactiv√© (Web Audio non disponible ou d√©j√† attach√©) :", e);
      audioCtx = null;
      analyser = null;
      dataArray = null;
      sourceNode = null;
    }
  }

  function resizeCanvas() {
    if (!canvas || !ctx) return;
    const rect = canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }

  function drawVisualizer() {
    if (!analyser || !ctx || !canvas) return;

    resizeCanvas();
    analyser.getByteFrequencyData(dataArray);

    const width = canvas.width / (window.devicePixelRatio || 1);
    const height = canvas.height / (window.devicePixelRatio || 1);

    ctx.clearRect(0, 0, width, height);

    const barCount = 40;
    const step = Math.floor(dataArray.length / barCount);
    const barWidth = width / barCount;

    for (let i = 0; i < barCount; i++) {
      const value = dataArray[i * step] || 0;
      const barHeight = (value / 255) * height * 0.8;
      const x = i * barWidth;
      const y = height - barHeight;

      const grad = ctx.createLinearGradient(x, y, x, height);
      grad.addColorStop(0, "#ffeb3b");
      grad.addColorStop(0.4, "#ff9800");
      grad.addColorStop(1, "#ff5722");

      ctx.fillStyle = grad;
      ctx.fillRect(x + barWidth * 0.15, y, barWidth * 0.17, barHeight);
    }

    animationId = requestAnimationFrame(drawVisualizer);
  }

  function startVisualizer() {
    if (!canvas || !ctx) return;
    initVisualizer();
    if (audioCtx && audioCtx.state === "suspended") {
      audioCtx.resume().catch(() => {});
    }
    if (analyser && !animationId) {
      animationId = requestAnimationFrame(drawVisualizer);
    }
  }

  function stopVisualizer() {
    if (animationId) {
      cancelAnimationFrame(animationId);
      animationId = null;
    }
    if (ctx && canvas) {
      const rect = canvas.getBoundingClientRect();
      ctx.clearRect(0, 0, rect.width, rect.height);
    }
  }

  function goToPrevStation() {
    if (stations.length === 0) return;
    currentIndex = (currentIndex - 1 + stations.length) % stations.length;
    stationSelect.value = currentIndex;
    loadCurrentStation(isPlaying);
  }

  function goToNextStation() {
    if (stations.length === 0) return;
    currentIndex = (currentIndex + 1) % stations.length;
    stationSelect.value = currentIndex;
    loadCurrentStation(isPlaying);
  }

  stationSelect.addEventListener("change", () => {
    const idx = parseInt(stationSelect.value, 10);
    if (!isNaN(idx)) {
      currentIndex = idx;
      loadCurrentStation(isPlaying);
    }
  });

  playPauseBtn.addEventListener("click", () => {
    if (!audio.src) {
      loadCurrentStation(true);
      return;
    }
    if (isPlaying) {
      audio.pause();
    } else {
      audio.play().then(() => {
        setStatusPlaying(true);
        startVisualizer();
      }).catch((err) => {
        console.warn("Erreur lecture :", err);
      });
    }
  });

  stopBtn.addEventListener("click", () => {
    if (!audio.src) return;
    audio.pause();
    audio.currentTime = 0;
    setStatusPlaying(false);
    stopVisualizer();
  });

  prevBtn.addEventListener("click", goToPrevStation);
  nextBtn.addEventListener("click", goToNextStation);

  audio.addEventListener("playing", () => {
    setStatusPlaying(true);
    startVisualizer();
  });
  audio.addEventListener("pause", () => {
    setStatusPlaying(false);
    stopVisualizer();
  });
  audio.addEventListener("ended", () => {
    setStatusPlaying(false);
    stopVisualizer();
  });

  volumeSlider.addEventListener("input", () => {
    audio.volume = parseFloat(volumeSlider.value);
  });

  addForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const name = newName.value.trim();
    const freq = parseFloat(newFreq.value.replace(",", "."));
    const url = newUrl.value.trim();

    if (!name || isNaN(freq) || !url) {
      alert("Merci de remplir tous les champs avec des valeurs valides.");
      return;
    }

    stations.push({
      name,
      freq,
      url,
      city: "Custom",
      desc: "Ajout manuel"
      // logo: "mon-logo.png" // optionnel
    });

    newName.value = "";
    newFreq.value = "";
    newUrl.value = "";

    refreshStationOptions();
    currentIndex = stations.findIndex(
      (s) => s.name === name && s.freq === freq && s.url === url
    );
    stationSelect.value = currentIndex;
    loadCurrentStation(true);
  });

  // Init
  refreshStationOptions();
</script>
</body>
</html>
